spring:
  application:
    name: study-cards
  profiles:
    default: dev

  ai:
    model:
      chat: ${APP_AI_PROVIDER}
      embedding: ${APP_AI_PROVIDER}
      image: ${APP_AI_PROVIDER}
      moderation: ${APP_AI_PROVIDER}
      audio:
        speech: ${APP_AI_PROVIDER}
        transcription: ${APP_AI_PROVIDER}

  # 공통 JPA 설정
  jpa:
    open-in-view: false
    properties:
      hibernate:
        jdbc:
          time_zone: Asia/Seoul

  # 공통 Redis 설정
  data:
    redis:
      timeout: 2s
    web:
      pageable:
        max-page-size: 100

  # 공통 Mail 설정
  mail:
    properties:
      mail:
        smtp:
          auth: true
          starttls:
            enable: true
            required: true
          connectiontimeout: 5000
          timeout: 5000
          writetimeout: 5000

  # 공통 OAuth2 Provider 설정 (URL은 환경 불변)
  security:
    oauth2:
      client:
        provider:
          kakao:
            authorization-uri: https://kauth.kakao.com/oauth/authorize
            token-uri: https://kauth.kakao.com/oauth/token
            user-info-uri: https://kapi.kakao.com/v2/user/me
            user-name-attribute: id
          naver:
            authorization-uri: https://nid.naver.com/oauth2.0/authorize
            token-uri: https://nid.naver.com/oauth2.0/token
            user-info-uri: https://openapi.naver.com/v1/nid/me
            user-name-attribute: response

server:
  port: 8080

logging:
  level:
    root: INFO

management:
  endpoints:
    web:
      exposure:
        include: health,info,metrics,prometheus
  endpoint:
    health:
      show-details: when_authorized
      probes:
        enabled: true
  health:
    livenessstate:
      enabled: true
    readinessstate:
      enabled: true

# 공통 커스텀 설정
app:
  ai:
    provider: ${APP_AI_PROVIDER}
  security:
    jwt:
      issuer: study-cards
      # dev/prod에서 각각 override
      secret: ${APP_JWT_SECRET}
      access-token-expire-minutes: 30
      refresh-token-expire-days: 14
    refresh-token:
      redis-prefix: "refresh:"
    blacklist:
      redis-prefix: "bl:"
  notification:
    daily-push-cron: "0 0 8 * * *"  # 매일 오전 8시
  generation:
    migrate-cron: "0 0 3 * * *"  # 매일 새벽 3시에 승인된 카드 이동
  payment:
    toss:
      api-url: https://api.tosspayments.com/v1
  subscription:
    renewal-check-cron: "0 0 9 * * *"  # 매일 오전 9시
    grace-period-days: 3
